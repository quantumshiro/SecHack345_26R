---
marp: true
math: mathjax
---
# BLS署名によるLPWAネットワーク上の分散台帳決済システムの通信データ長改善の評価

---
## あぶすと
- 2022年CSISで、分散台帳をIoTデバイスとLow Power Wide Area networkを用いてポイント交換をする方法が考案された
- 課題
    - 口座を管理しているノードたちそれぞれが、署名付きのデータをP2Pネットワーク上でブロードキャストしているため帯域を圧迫する
- 今回
    - 他ノードのメッセージを中継する際に、複数のメッセージを1つのメッセージに集約
    - BLS署名を用いて複数の署名長を、署名1つ分と同じ長さの署名データに集約

---
## ペアリング
- $G_1, G_2$は素数位数$p$の加法巡回群とし、$G_T$を乗法巡回群とする。
- 3つの巡回群について、
$$
e: G_1 \times G_2 \rightarrow G_T
$$
という関係が成り立つ写像のことを指す。

- $P$は$G_1$の生成元、$Q$は$G_2$の生成元とする。
- 双線形性
    - 任意の$a \in \mathbb{Z}$に対し、
    $$
        e(aP, Q) = e(P, aQ) = e(P, Q)^a
    $$
- 非退化性
    - $e(P, Q) \ne 1^{G_T}$
    - $1^{G_T}$は$G_T$の単位元

---
## BLS署名
### 鍵生成
1. $1 < s < p$を満たす自然数$s$をランダムに選ぶ。
2. $y = sQ$を求める
3. 秘密鍵: $s$, 公開鍵 $y$

---
### 署名
- 暗号学的ハッシュ関数を$H: {0, 1}^* \rightarrow G$とする。
- 署名対象$m$に対する署名$\sigma$を求める
$$
    \sigma = sH(m)
$$

---
### 検証
$$
    e(\sigma, Q) = e(H(m), y)
$$
が成り立てば署名を受理する

---
## Low Power Wide Area network
- なるべく消費電力を抑えて遠距離通信を実現する通信方式
- 通信速度は高々数百kbpsしか出ない
- 遠距離通信

---
## 想定するアプリケーション
- ポイントを支払う人が所有者タグを用いて、店舗端末の所有者に対して自身が所有するポイントを移転するもの
- ポイントを支払う時には、ポイントの所有者が持つ所有者タグと店舗などに設置されている店舗端末が通信を行いながら、双方が必要な情報を作成し、それらを店舗端末が取りまとめる
- 店舗端末は窓口ノードと通信を行い、台帳へ取引を記録することを要求する。(店舗端末などのように分散台帳に関して支払い情報を取りまとめて送信する役割を持つものをクライアントとする)
- 窓口ノードとはノードの中でも特に、店舗端末の近隣にあり、取引の記録の要求を受けたもの
- 窓口ノードは、他のノードと通信を行い、分散台帳を更新する合意を取る。合意が取れたらすべてのノードは取引を分散台帳に記録する
---
## システムに関する方針
1. 計算能力の乏しいIoTデバイスと、通信速度が遅く帯域の狭いLPWANと使用する環境においても動作可能な軽量な分散台帳の合意アルゴリズムを目指す。
2. 各ノードは、他のノードの公開鍵を知っている。
3. 各ノードは、口座の持ち主の公開鍵を知っている。
4. 分散台帳はハッシュチェーンによって構成されている
---

## 分散台帳の合意アルゴリズムの手順
1. クライアントは以下のものを窓口ノードへ転移メッセージを送る
    - ポイントの移転元の口座の識別子
    - 転移先の口座の識別子
    - 移転するポイントの量
    - ユニークな値(日付など、リプレイ防止に用いる)
    - これらに対応する転移元の口座の所有者の署名
    - 移転先の所有者の署名
---
2. クライアントからの要求を受け取った窓口ノードは署名$sig_{from}, sig_{to}$を検証する
3. 手順2の検証を通過したら、窓口ノードは
$a_{from}$, $a_{to}$, $p$, $M$, $sig_{from}$, $sig_{to}$, $ID_{rid}$および、それに対応する窓口ノードの署名$sig_{reception}$をつけて他のノードに対してポイントの転移を求めるメッセージをブロードキャストする
